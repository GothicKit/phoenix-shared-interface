name: 'Build'
on:
  - 'push'
  - 'pull_request'
jobs:
  linux:
    name: "Linux"
    runs-on: 'ubuntu-latest'
    container:
      image: 'ghcr.io/lmichaelis/images:clang-14'
    steps:
      - uses: 'actions/checkout@v3'
        with:
          submodules: 'recursive'
      - name: 'Configure'
        run: 'cmake -B build -DCMAKE_BUILD_TYPE=Release'
      - name: 'Build'
        run: 'cmake --build build --config Release'
      - name: 'Publish Library'
        uses: 'actions/upload-artifact@v3'
        with:
          name: 'Linux x86-64 Shared Object'
          path: 'build/phoenix-shared*'
  macos:
    name: "MacOS"
    runs-on: 'macos-11'
    steps:
      - uses: 'actions/checkout@v3'
        with:
          submodules: 'recursive'
      - uses: 'maxim-lobanov/setup-xcode@v1'
        with:
          xcode-version: 14
      - name: 'Configure'
        run: 'cmake -B build -DCMAKE_BUILD_TYPE=Release'
      - name: 'Build'
        run: 'cmake --build build --config Release'
      - name: 'Publish Library'
        uses: 'actions/upload-artifact@v3'
        with:
          name: 'Linux x86-64 Dynamic Library'
          path: 'build/phoenix-shared*'
  windows:
    name: "Windows"
    runs-on: 'windows-2019'
    steps:
      - uses: 'actions/checkout@v3'
        with:
          submodules: 'recursive'
      - name: 'Configure'
        shell: 'bash'
        run: 'cmake -B build -G "Visual Studio 16 2019" -DCMAKE_BUILD_TYPE=Release'
      - name: 'Build'
        run: 'cmake --build build --config Release'
      - name: 'Publish Library'
        uses: 'actions/upload-artifact@v3'
        with:
          name: 'Windows x86-64 DLL'
          path: 'build/phoenix-shared*'
